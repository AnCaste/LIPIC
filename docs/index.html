<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LIPIC: Lipid Isotopic Pattern Interference Correction • LIPIC</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="LIPIC: Lipid Isotopic Pattern Interference Correction">
<meta property="og:description" content='The LIPIC package is focused on the correction of Type I and Type II isotopic effects in lipid class-related High-Resolution Mass Spectra.
    Briefly, the Type II isotopic effect refers to the alteration of the M+0 peak intensity induced by the overlap with M+2 or even M+4 isotopologue peaks of lipids having one or two additional double bonds, respectively.
    Type II isotopic effect is largely common in mass spectra carried out by shotgun or by HILIC-MS.
    Moreover, Type I isotopic effect (i.e. the reduction of M+0 intensity due to the increase of the amount of  C atoms in the molecule) needs to be considered for quantitative purposes.
    Since the extent of both Type I and Type II isotope effects increases with the overall C atom number, the corresponding corrections are strongly recommended in mass spectra of large lipid molecules (e.g. cardiolipins, N-acylphosphatidylethanolamines, gangliosides).
    Both Type I and Type II corrections are performed by the LIPIC package main functions, namely Lipic and Lipic_It.
    For details on the LIPIC theoretical workflow see A.Castellaneta et al.: "LIPIC: an automated workflow to account for isotopologues-related interferences in electrospray ionization high resolution mass spectra of phospholipids", Journal of the American Society for Mass Spectrometry, 2021 (DOI: https://doi.org/10.1021/jasms.1c00008).'>
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">LIPIC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/AnCaste/LIPIC/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<center>
<img src="reference/figures/Lipic_Logo.png" width="350">
</center>
<div id="getting-started" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting Started</h1></div>
<p>In lipidomics shotgun and HILIC-MS methods, monoisotopologue (M+0) peak can be used for quantitative purposes. However, intrinsic M+0 intensity differences should be taken into account when ions with different isotopic pattern distribution are considered. This is commonly referred to as the “Type I” isotopic effect. Particularly, it becomes noticeable as the carbon atom difference increases. Furthermore, isotopic pattern overlap is another major issue in lipid class-related mass spectra. Indeed, lipids differing by only the number of C=C bonds frequently occur within the same class. Here, the monoisotopologue M+0 peak intensity is artificially enhanced by M+2 and M+4 isotopologues of lipids with one or two additional double bonds, respectively. This kind of interference is commonly known as either the “double bond overlapping effect” or the “Type II” effect. Moreover, Type II correction should account for complications in High Resolution mass spectra. These are due to the misalignment between the M+0 and the interfering isotopologue peaks. As a consequence, Type II correction can no longer be performed by simply subtracting the expected peak intensities of the M+2 and M+4 interfering isotopologues to that of the convoluted M+0 peak. The <strong><code>LIPIC</code></strong> package has been specifically designed for performing both Type I and Type II corrections in lipid class high resolution mass spectra. Nevertheless, the correction can be applied to lower resolution spectra as well.</p>
<div id="dependencies-on-other-r-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#dependencies-on-other-r-packages" class="anchor"></a>Dependencies on other R Packages</h3>
<p>LIPIC is based on functions from other R packages, namely <a href="https://cran.rstudio.com/web/packages/enviPat/index.html">enviPat</a> for isotope fine structure calculation and <a href="https://cran.r-project.org/web/packages/plotly/index.html">plotly</a> for the interactive graphical output. Hence, the user needs to install the aforementioned R packages using the following code lines:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"enviPat"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"plotly"</span><span class="op">)</span></code></pre></div>
<p>Moreover, the <code>pick.peaks</code> function (from the ChemometricsWithR package) has been added to the LIPIC package.</p>
</div>
<div id="install-lipic" class="section level3">
<h3 class="hasAnchor">
<a href="#install-lipic" class="anchor"></a>Install Lipic</h3>
<p>The user can install the developement version of <code>LIPIC</code> from GitHub. For this purpose, the <code>devtools</code> package must have been formerly installed.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"AnCaste/LIPIC"</span><span class="op">)</span></code></pre></div>
</div>
<div id="uninstall-lipic" class="section level3">
<h3 class="hasAnchor">
<a href="#uninstall-lipic" class="anchor"></a>Uninstall LIPIC</h3>
<p>If no longer needed, the LIPIC package can be removed in any moment using the following code line:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/remove.packages.html">remove.packages</a></span><span class="op">(</span><span class="st">"LIPIC"</span><span class="op">)</span></code></pre></div>
</div>
<div id="load-lipic" class="section level3">
<h3 class="hasAnchor">
<a href="#load-lipic" class="anchor"></a>Load LIPIC</h3>
<p>Prior to further operations, the content of the Lipic Package can be loaded into the R environment using the <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> function, as shown below.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/AnCaste/LIPIC">"LIPIC"</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="lipic-package-main-functions-lipic-and-lipic_it" class="section level2">
<h2 class="hasAnchor">
<a href="#lipic-package-main-functions-lipic-and-lipic_it" class="anchor"></a>LIPIC Package main Functions: Lipic and Lipic_It</h2>
<p>Both Type I and Type II corrections can be performed using either the <code>Lipic_It</code> or the <code>Lipic</code> functions. The choice of a function rather than the other depends upon the user’s preliminary information. Indeed, the reliability of the <code>LIPIC</code> correction workflow depends on <strong><code>dmz</code></strong> values. Here, the “dmz” symbol refers to the absolute error in the measurement of each M+0 peak <em>m/z</em>. Specifically, <code>dmz</code> is obtained by the difference between the measured M+0 peak <em>m/z</em> and its theoretical value.</p>
<p>Tipically, <code>dmz</code> values are initially unknown. In this case, the user should refer to the <code>Lipic_It</code> function. <code>Lipic_It</code> can calculate an estimate of <code>dmz</code> for each M+0 peak using a recursive approach. When convergence is reached, the <code>dmz</code> referred to the last iteration are used to build the output.</p>
<p>Conversely, if the user already retrieved information about <code>dmz</code>, he could use the <code>Lipic</code> function specifying the corresponding values in the input data frame, as described in the next section.</p>
<div id="lipic-and-lipic_it-input-arguments" class="section level3">
<h3 class="hasAnchor">
<a href="#lipic-and-lipic_it-input-arguments" class="anchor"></a>Lipic and Lipic_It: Input Arguments</h3>
<p><code>Lipic</code> and <code>Lipic_It</code> share the same input arguments, namely the <strong>input data frame</strong> (<em>data</em>), the lipid ions <strong>charge state</strong> (<em>z</em>, the sign must be specified as well) and the <strong>operating resolving power of the mass spectrometer</strong> (<em>Res</em>). The values of the remaining parameters (i.e. <em>span</em>, <em>ppm</em> and <em>xseq</em>) are set as default. Check <code>Lipic</code> and <code>Lipic_It</code> help pages for further details.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/Lipic_It.html">Lipic_It</a></span><span class="op">(</span><span class="va">data</span>,<span class="va">z</span>,<span class="va">Res</span>,span<span class="op">=</span><span class="fl">25</span>,ppm<span class="op">=</span><span class="fl">10</span>,xseq<span class="op">=</span><span class="fl">0.001</span><span class="op">)</span>
<span class="co">## A typical code line to run the Lipic_It function. The input data frame,z and Res need to be specified by the user.</span>

<span class="fu"><a href="reference/Lipic.html">Lipic</a></span><span class="op">(</span><span class="va">data</span>,<span class="va">z</span>,<span class="va">Res</span>,span<span class="op">=</span><span class="fl">25</span>,ppm<span class="op">=</span><span class="fl">10</span>,xseq<span class="op">=</span><span class="fl">0.001</span><span class="op">)</span>
<span class="co">## A typical code line to run the Lipic function. The input data frame,z and Res need to be specified by the user.</span></code></pre></div>
<div id="the-input-data-frame" class="section level4">
<h4 class="hasAnchor">
<a href="#the-input-data-frame" class="anchor"></a>The Input Data Frame</h4>
<p>This section is focused on the <strong>input data frame</strong> structure and how to build it properly. The <code>LIPIC</code> package offers an example of input data frame, namely <code>CLmix</code>. It contains specific information for all the identified the sum compositions attributed to the corresponding <span class="math display"><em>M</em> − 2<em>H</em></span><sup>2−</sup> ions in the direct infusion ESI(-)-MS spectrum of a Cardiolipin mix purchased from Avanti Polar Lipids. Such spectrum is embedded in the LIPIC package as a data frame named <code>CLmixSpectrum</code>. Both <code>CLmix</code> and <code>CLmixSpectrum</code> can be loaded into the R environment using the <code><a href="https://rdrr.io/r/utils/data.html">data()</a></code> function as shown below.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"CLmix"</span><span class="op">)</span>
<span class="co">## Load the CLmix data frame.</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"CLmixSpectrum"</span><span class="op">)</span>
<span class="co">## Load the spectrum of the Cardiolipin mix.</span></code></pre></div>
<p>The <code>CLmixSpectrum</code> can be exported as a Tab Separated Value .txt file using the <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="va">CLMixSpectrum</span>,<span class="st">"C:/Documents/Spectra/CLMixSpectrum.txt"</span>,sep<span class="op">=</span><span class="st">"\t"</span>,row.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="co">## The file path ("C:/Documents/Spectra/CLMixSpectrum.txt") is illustrative only. The you need to replace it with the file path leading to the position in which you want the .txt to be saved.</span></code></pre></div>
<p>Let us now focus on the data frame content. The first two columns must be filled with the sum composition and the chemical formula for all the identified lipids in the mass spectrum. The remaining three columns refer to the corresponding M+0 peak parameters, i.e the m/z, dmz and intensity value, respectively.</p>
<p><strong>N.B.</strong> The elements in the input data frame must be listed following the ascending order of <em>m/z</em>. This is a mandatory requiement for LIPIC functions to perform a reliable correction.</p>
<p>As shown below, when dmz values are not known, the dmz column should be filled with zeros. Than, the <code>Lipic_It</code> function has to be employed for Type I and Type II corrections. As will be further pointed out, <code>Lipic_It</code> will return a dmz estimate for each lipid.</p>
<table class="table">
<thead><tr class="header">
<th align="center">Sum Composition</th>
<th align="center">Formula</th>
<th align="center">Measured m/z</th>
<th align="center">dmz</th>
<th align="center">Intensity</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">CL 70:8</td>
<td align="center">C79H136O17P2</td>
<td align="center">709.4623</td>
<td align="center">0</td>
<td align="center">1016080</td>
</tr>
<tr class="even">
<td align="center">CL 70:7</td>
<td align="center">C79H138O17P2</td>
<td align="center">710.4693</td>
<td align="center">0</td>
<td align="center">12176987</td>
</tr>
<tr class="odd">
<td align="center">CL 70:6</td>
<td align="center">C79H140O17P2</td>
<td align="center">711.4784</td>
<td align="center">0</td>
<td align="center">23126606</td>
</tr>
<tr class="even">
<td align="center">CL 70:5</td>
<td align="center">C79H142O17P2</td>
<td align="center">712.4829</td>
<td align="center">0</td>
<td align="center">10350815</td>
</tr>
<tr class="odd">
<td align="center">CL 70:4</td>
<td align="center">C79H144O17P2</td>
<td align="center">713.4917</td>
<td align="center">0</td>
<td align="center">2470070</td>
</tr>
<tr class="even">
<td align="center">CL 71:7</td>
<td align="center">C80H140O17P2</td>
<td align="center">717.4781</td>
<td align="center">0</td>
<td align="center">2258730</td>
</tr>
<tr class="odd">
<td align="center">CL 71:6</td>
<td align="center">C80H142O17P2</td>
<td align="center">718.4862</td>
<td align="center">0</td>
<td align="center">2275952</td>
</tr>
<tr class="even">
<td align="center">CL 71:5</td>
<td align="center">C80H144O17P2</td>
<td align="center">719.4941</td>
<td align="center">0</td>
<td align="center">1831880</td>
</tr>
<tr class="odd">
<td align="center">CL 71:4</td>
<td align="center">C80H146O17P2</td>
<td align="center">720.4996</td>
<td align="center">0</td>
<td align="center">1241680</td>
</tr>
<tr class="even">
<td align="center">CL 72:10</td>
<td align="center">C81H136O17P2</td>
<td align="center">721.4612</td>
<td align="center">0</td>
<td align="center">1009175</td>
</tr>
<tr class="odd">
<td align="center">CL 72:9</td>
<td align="center">C81H138O17P2</td>
<td align="center">722.4708</td>
<td align="center">0</td>
<td align="center">21706585</td>
</tr>
<tr class="even">
<td align="center">CL 72:8</td>
<td align="center">C81H140O17P2</td>
<td align="center">723.4779</td>
<td align="center">0</td>
<td align="center">526420104</td>
</tr>
<tr class="odd">
<td align="center">CL 72:7</td>
<td align="center">C81H142O17P2</td>
<td align="center">724.4802</td>
<td align="center">0</td>
<td align="center">291071934</td>
</tr>
<tr class="even">
<td align="center">CL 72:6</td>
<td align="center">C81H144O17P2</td>
<td align="center">725.4915</td>
<td align="center">0</td>
<td align="center">79097022</td>
</tr>
<tr class="odd">
<td align="center">CL 72:5</td>
<td align="center">C81H146O17P2</td>
<td align="center">726.4956</td>
<td align="center">0</td>
<td align="center">28824140</td>
</tr>
<tr class="even">
<td align="center">CL 72:4</td>
<td align="center">C81H148O17P2</td>
<td align="center">727.5041</td>
<td align="center">0</td>
<td align="center">4486245</td>
</tr>
<tr class="odd">
<td align="center">CL 74:10</td>
<td align="center">C83H140O17P2</td>
<td align="center">735.4760</td>
<td align="center">0</td>
<td align="center">11987946</td>
</tr>
<tr class="even">
<td align="center">CL 74:9</td>
<td align="center">C83H142O17P2</td>
<td align="center">736.4820</td>
<td align="center">0</td>
<td align="center">20176370</td>
</tr>
<tr class="odd">
<td align="center">CL 74:8</td>
<td align="center">C83H144O17P2</td>
<td align="center">737.4901</td>
<td align="center">0</td>
<td align="center">15311198</td>
</tr>
<tr class="even">
<td align="center">CL 74:7</td>
<td align="center">C83H146O17P2</td>
<td align="center">738.4978</td>
<td align="center">0</td>
<td align="center">8180636</td>
</tr>
<tr class="odd">
<td align="center">CL 74:6</td>
<td align="center">C83H148O17P2</td>
<td align="center">739.5029</td>
<td align="center">0</td>
<td align="center">3781301</td>
</tr>
</tbody>
</table>
<p>Conversely, if the user had preliminary information about dmz values, he could use them to compile the fourth column of the input data frame. In such case, the <code>Lipic</code> function can be used for both the isotopic corrections.</p>
<div id="the-visualspec-function-as-a-tool-for-building-the-input-data-frame" class="section level5">
<h5 class="hasAnchor">
<a href="#the-visualspec-function-as-a-tool-for-building-the-input-data-frame" class="anchor"></a>The VisualSpec Function as a Tool for Building the Input Data Frame</h5>
<p>The user can easily retrieve the <em>m/z</em> and intensity values of each M+0 peak using the <code>VisualSpec</code> function included in the LIPIC package. Specifically, <code>VisualSpec</code> performs a peak peaking operation powered by the <code>pick.peaks</code>.</p>
<p><code>pick.peaks</code> belongs to the ChemometricsWithR package, but has been included in LIPIC.</p>
<p><code>VisualSpec</code> returns a data frame in which the <em>m/z</em> and intensity values are listed for all the identified peaks. Furthermore, it generates a <code>plotly</code> interactive version of the mass spectrum.</p>
<p>As shown below, <code>VisualSpec</code> requires in input the file path to the Tab Separated Value .txt file of the mass spectrum. The remaining parameters (i.e. mzmin and mzmax) are set to 0. These default values should not be changed if the full <em>m/z</em> range needs to be considered. Otherwise, if the user is interested in a part of the mass spectrum, he should indicate the corresponding boundary values in order to focus the visualization and the peak picking operation to a specific spectral region. Check the <code>VisualSpec</code> help page for further information.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>VisualSpec<span class="ot">=</span><span class="cf">function</span>(path,<span class="at">mzmin=</span><span class="dv">0</span>,<span class="at">mzmax=</span><span class="dv">0</span>,<span class="at">span=</span><span class="dv">25</span>)</span></code></pre></div>
<p>The application of <code>VisualSpec</code> to the Cardiolipin Mix is shown below.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/VisualSpec.html">VisualSpec</a></span><span class="op">(</span><span class="st">"C:/Documents/Spectra/CLMixSpectrum.txt"</span><span class="op">)</span>
<span class="co">## The file path ("C:/Documents/Spectra/CLMixSpectrum.txt") is illustrative only. You need to replace it with the file path in which your .txt file is stored.</span></code></pre></div>
<p>Click <a href="https://chart-studio.plotly.com/~AnCaste/3/#/">here</a> to see the interactive output.</p>
</div>
</div>
<div id="the-output-data-frame" class="section level4">
<h4 class="hasAnchor">
<a href="#the-output-data-frame" class="anchor"></a>The Output Data Frame</h4>
<p>The <strong>output data frame</strong> (ODF) returned by both <code>Lipic</code> and <code>Lipic_It</code> can be considered as an extension of the input data frame. Particularly, when <code>Lipic_It</code> is employed, the <code>dmz</code> column of the ODF is automatically compiled by the <code>dmz</code> values calculated by the function itself. Conversely, when <code>Lipic</code> is used, the <code>dmz</code> column shows the same <code>dmz</code> values indicated by the user in the input data frame.</p>
<p>In particular, when the <code>CLmix</code> dataset is used as input of the <code>Lipic_It</code> function, the following output data frame is obtained:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ODF</span><span class="op">=</span><span class="fu"><a href="reference/Lipic_It.html">Lipic_It</a></span><span class="op">(</span><span class="va">CLmix</span>,<span class="op">-</span><span class="fl">2</span>,<span class="fl">75000</span><span class="op">)</span>
<span class="co">## Here, the output data frame generated by the Lipic_It function is assigned to the "ODF" variable.</span></code></pre></div>
<table class="table">
<colgroup>
<col width="7%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="8%">
<col width="7%">
<col width="7%">
<col width="10%">
<col width="11%">
<col width="13%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="center">Sum Composition</th>
<th align="center">Formula</th>
<th align="center">Measured m/z</th>
<th align="center">dmz</th>
<th align="center">Measured Intensity</th>
<th align="center">Type II</th>
<th align="center">Type II &amp; Type I</th>
<th align="center">Lipid Class Adj-RA (%)</th>
<th align="center">Lipid Class UnAdj-RA (%)</th>
<th align="center">Most Abundant Lipid Adj-RA (%)</th>
<th align="center">Most Abundant Lipid UnAdj-RA (%)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">CL 70:8</td>
<td align="center">C79H136O17P2</td>
<td align="center">709.462338</td>
<td align="center">-0.000848516</td>
<td align="center">1016079.965</td>
<td align="center">1016079.9650</td>
<td align="center">2516235.426</td>
<td align="center">0.1252130837</td>
<td align="center">0.0929741276</td>
<td align="center">0.1897999332</td>
<td align="center">0.1888221388</td>
</tr>
<tr class="even">
<td align="center">CL 70:7</td>
<td align="center">C79H138O17P2</td>
<td align="center">710.469288</td>
<td align="center">-0.001898516</td>
<td align="center">12176987.420</td>
<td align="center">11974702.3341</td>
<td align="center">29661138.020</td>
<td align="center">1.4759996297</td>
<td align="center">1.1144838519</td>
<td align="center">2.2373431188</td>
<td align="center">2.2634170382</td>
</tr>
<tr class="odd">
<td align="center">CL 70:6</td>
<td align="center">C79H140O17P2</td>
<td align="center">711.478384</td>
<td align="center">0.000197484</td>
<td align="center">23126605.970</td>
<td align="center">20255145.5254</td>
<td align="center">50183176.551</td>
<td align="center">2.4972187499</td>
<td align="center">2.1171202257</td>
<td align="center">3.7853228915</td>
<td align="center">4.2996818509</td>
</tr>
<tr class="even">
<td align="center">CL 70:5</td>
<td align="center">C79H142O17P2</td>
<td align="center">712.482868</td>
<td align="center">-0.000318516</td>
<td align="center">10350815.020</td>
<td align="center">3061781.2415</td>
<td align="center">7587463.842</td>
<td align="center">0.3775679076</td>
<td align="center">0.9477807060</td>
<td align="center">0.5723232872</td>
<td align="center">1.9248578567</td>
</tr>
<tr class="odd">
<td align="center">CL 70:4</td>
<td align="center">C79H144O17P2</td>
<td align="center">713.491739</td>
<td align="center">0.000552484</td>
<td align="center">2470070.396</td>
<td align="center">1413423.4277</td>
<td align="center">3503438.164</td>
<td align="center">0.1743383355</td>
<td align="center">0.2262259087</td>
<td align="center">0.2642647515</td>
<td align="center">0.4594445898</td>
</tr>
<tr class="even">
<td align="center">CL 71:7</td>
<td align="center">C80H140O17P2</td>
<td align="center">717.478096</td>
<td align="center">-0.001090516</td>
<td align="center">2258730.451</td>
<td align="center">2267125.7973</td>
<td align="center">5677667.645</td>
<td align="center">0.2825324954</td>
<td align="center">0.2090112171</td>
<td align="center">0.4282671362</td>
<td align="center">0.4244830907</td>
</tr>
<tr class="odd">
<td align="center">CL 71:6</td>
<td align="center">C80H142O17P2</td>
<td align="center">718.486184</td>
<td align="center">0.000997484</td>
<td align="center">2275952.222</td>
<td align="center">1655627.1830</td>
<td align="center">4147215.370</td>
<td align="center">0.2063740220</td>
<td align="center">0.2106531810</td>
<td align="center">0.3128249416</td>
<td align="center">0.4278177725</td>
</tr>
<tr class="even">
<td align="center">CL 71:5</td>
<td align="center">C80H144O17P2</td>
<td align="center">719.494110</td>
<td align="center">0.000923484</td>
<td align="center">1831880.435</td>
<td align="center">1373308.2461</td>
<td align="center">3440818.470</td>
<td align="center">0.1712222499</td>
<td align="center">0.1695905689</td>
<td align="center">0.2595413406</td>
<td align="center">0.3444232794</td>
</tr>
<tr class="odd">
<td align="center">CL 71:4</td>
<td align="center">C80H146O17P2</td>
<td align="center">720.499573</td>
<td align="center">-0.000613516</td>
<td align="center">1241680.246</td>
<td align="center">845610.9472</td>
<td align="center">2119161.328</td>
<td align="center">0.1054538546</td>
<td align="center">0.1149778107</td>
<td align="center">0.1598485875</td>
<td align="center">0.2335096515</td>
</tr>
<tr class="even">
<td align="center">CL 72:10</td>
<td align="center">C81H136O17P2</td>
<td align="center">721.461196</td>
<td align="center">-0.001990516</td>
<td align="center">1009174.578</td>
<td align="center">1009174.5780</td>
<td align="center">2553482.050</td>
<td align="center">0.1270665528</td>
<td align="center">0.0943503790</td>
<td align="center">0.1926094505</td>
<td align="center">0.1916171823</td>
</tr>
<tr class="odd">
<td align="center">CL 72:9</td>
<td align="center">C81H138O17P2</td>
<td align="center">722.470787</td>
<td align="center">-0.000399516</td>
<td align="center">21706585.310</td>
<td align="center">21499157.4820</td>
<td align="center">54411117.049</td>
<td align="center">2.7076098214</td>
<td align="center">2.0298715193</td>
<td align="center">4.1042369390</td>
<td align="center">4.1224875305</td>
</tr>
<tr class="even">
<td align="center">CL 72:8</td>
<td align="center">C81H140O17P2</td>
<td align="center">723.477884</td>
<td align="center">-0.001302516</td>
<td align="center">526420104.100</td>
<td align="center">523708139.9260</td>
<td align="center">1325730406.349</td>
<td align="center">65.9710894284</td>
<td align="center">49.2389971904</td>
<td align="center">100.0000000000</td>
<td align="center">100.0000000000</td>
</tr>
<tr class="odd">
<td align="center">CL 72:7</td>
<td align="center">C81H142O17P2</td>
<td align="center">724.480154</td>
<td align="center">-0.003032516</td>
<td align="center">291071933.900</td>
<td align="center">102823948.0437</td>
<td align="center">260351364.829</td>
<td align="center">12.9556228700</td>
<td align="center">27.2318254486</td>
<td align="center">19.6383339767</td>
<td align="center">55.3054022268</td>
</tr>
<tr class="even">
<td align="center">CL 72:6</td>
<td align="center">C81H144O17P2</td>
<td align="center">725.491457</td>
<td align="center">0.000270484</td>
<td align="center">79097022.300</td>
<td align="center">40463772.8341</td>
<td align="center">102478237.296</td>
<td align="center">5.0995292291</td>
<td align="center">7.4017812630</td>
<td align="center">7.7299454554</td>
<td align="center">15.0323558263</td>
</tr>
<tr class="odd">
<td align="center">CL 72:5</td>
<td align="center">C81H146O17P2</td>
<td align="center">726.495593</td>
<td align="center">-0.003593516</td>
<td align="center">28824140.490</td>
<td align="center">14617892.8089</td>
<td align="center">37029660.761</td>
<td align="center">1.8426725750</td>
<td align="center">2.6979392478</td>
<td align="center">2.7931516532</td>
<td align="center">5.4792733438</td>
</tr>
<tr class="even">
<td align="center">CL 72:4</td>
<td align="center">C81H148O17P2</td>
<td align="center">727.504142</td>
<td align="center">-0.001044516</td>
<td align="center">4486244.889</td>
<td align="center">-5596529.7140</td>
<td align="center">0.000</td>
<td align="center">0.0000000000</td>
<td align="center">0.4200088707</td>
<td align="center">0.0000000000</td>
<td align="center">0.8530004563</td>
</tr>
<tr class="odd">
<td align="center">CL 74:10</td>
<td align="center">C83H140O17P2</td>
<td align="center">735.476037</td>
<td align="center">-0.003149516</td>
<td align="center">11987945.850</td>
<td align="center">11987945.8500</td>
<td align="center">31006567.124</td>
<td align="center">1.5429509671</td>
<td align="center">1.1456831502</td>
<td align="center">2.3388289938</td>
<td align="center">2.3267800231</td>
</tr>
<tr class="even">
<td align="center">CL 74:9</td>
<td align="center">C83H142O17P2</td>
<td align="center">736.482025</td>
<td align="center">-0.004161516</td>
<td align="center">20176370.440</td>
<td align="center">16883633.3425</td>
<td align="center">43679183.405</td>
<td align="center">2.1735665870</td>
<td align="center">1.9286902323</td>
<td align="center">3.2947259259</td>
<td align="center">3.9169973850</td>
</tr>
<tr class="odd">
<td align="center">CL 74:8</td>
<td align="center">C83H144O17P2</td>
<td align="center">737.490078</td>
<td align="center">-0.002108516</td>
<td align="center">15311198.400</td>
<td align="center">9947342.6919</td>
<td align="center">25740503.697</td>
<td align="center">1.2809007497</td>
<td align="center">1.4639626100</td>
<td align="center">1.9416092121</td>
<td align="center">2.9731771432</td>
</tr>
<tr class="even">
<td align="center">CL 74:7</td>
<td align="center">C83H146O17P2</td>
<td align="center">738.497823</td>
<td align="center">-0.002363516</td>
<td align="center">8180636.426</td>
<td align="center">4761241.0078</td>
<td align="center">12323379.741</td>
<td align="center">0.6132368867</td>
<td align="center">0.7823617279</td>
<td align="center">0.9295539789</td>
<td align="center">1.5889067052</td>
</tr>
<tr class="odd">
<td align="center">CL 74:6</td>
<td align="center">C83H148O17P2</td>
<td align="center">739.502867</td>
<td align="center">-0.004319516</td>
<td align="center">3781300.769</td>
<td align="center">2094541.0227</td>
<td align="center">5422483.508</td>
<td align="center">0.2698340045</td>
<td align="center">0.3617107631</td>
<td align="center">0.4090185668</td>
<td align="center">0.7346022132</td>
</tr>
</tbody>
</table>
<p>If compared to the input data frame, the ODF shows 6 additional columns. Among these, the content of the 8th column (i.e. <strong>“lipid class Adj-RA(%)”</strong>) is particularly important for quantitative purposes. Specifically, the “lipid class (%)RA” refers to the percentage ratio between the M+0 peak intensity and the sum of all the M+0 intensities detected for all the sum composition identified for a specific lipid class. Here, the <em>“Adj”</em> notation indicates that the considered intensities have been corrected for both Type I and Type II isotopic effect. If equal ionization yields are assumed, the “lipid class Adj-RA(%)” values can be considered an estimate of the percentage molar fraction of the corresponding sum compositions. On the other hand, the <em>“UnAdj-RA(%)”</em> notation in <strong>“lipid class UnAdj-RA(%)”</strong> (9th column) indicates that such relative abundances are calculated when only Type I correction is performed on measured intensities. Therefore, the comparison between the values in the 8th and 9th column allows the user to perceive the extent of Type II correction. Moreover, such comparison is graphically enhanced by the <strong>interactive bar chart</strong> output powered by <code>plotly</code>. Click <a href="https://chart-studio.plotly.com/~AnCaste/7">here</a> for a preview on the bar chart created by <code>Lipic_It</code> when using the <code>CLmix</code> as input data frame.</p>
<p>Let us focus on the 10th and 11th columns. Here, the term “most abundant lipid (%)RA” refers to the percentage ratio between the M+0 peak intensity and highest M+0 peak intensities detected among all the sum composition. Again, when the <em>“Adj”</em> notation is used, these intensities are corrected for both Type I and Type II isotope effect. Conversely, the <em>“UnAdj”</em> term indicates that only Type I correction has been performed on measured intensities.</p>
<p>The user can check the effects of isotope correction by comparing the values in the 5th, 6th and 7th columns. Specifically, the 5th column (“Measured Intensity”) shows the M+0 peak measured intensities (i.e. those indicated in the input data frame). The 6th shows the corresponding values after Type II correction, whereas the 7th column reports both Type I and Type II correction results. In particular, the values in the 7th column correspond to a reliable estimate of the overall intensity distributed over the whole isotopic pattern. The user can refer to them for quantitative purposes.</p>
<p>Both <code>Lipic</code> and <code>Lipic_It</code> offer another validation tool. If required by the user, an interactive spectra comparison is generated in the R Studio viewer pane.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ODF<span class="ot">=</span><span class="fu">Lipic_It</span>(CLmix,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">75000</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>Do you wish to compare the real spectrum with the simulated ones? (yes<span class="sc">/</span>no)<span class="sc">:</span> yes</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Type yes to ask for spectra comparison.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>Please, paste .txt mass spectrum file path<span class="sc">:</span> <span class="st">"C:/Documents/Spectra/CLMixSpectrum.txt"</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="do">## The file path ("C:/Documents/Spectra/CLMixSpectrum.txt") is illustrative only. You need to replace it with the file path lin which your spectrum .txt file is stored.</span></span></code></pre></div>
<p>The interactive plot displays the overlap between the real mass spectrum (green line) and two simulated mass spectra (blue and red lines). The <strong>corrected simulated spectrum</strong> (blue line) is calculated considering the effect of both Type I and Type II corrections. Conversely, in the <strong>uncorrected simulated spectrum</strong> (red line) the consequences of Type II isotopic effect are neglected. The user can choose which spectra to be shown in the overlaid visualization by selecting them using the interactive legend. You can do it by clicking on the coloured line and making the corresponding spectrum disappear. <a href="https://chart-studio.plotly.com/~AnCaste/11/#/">Here</a> you can practice with the interactive spectra comparison generated by <code>Lipic_It</code> for the main ion cluster in the Cardiolipin mix mass spectrum.</p>
<p><strong>N.B.</strong> The simulated spectra are calculated starting from theoretical <em>m/z</em> values. As a consequence, they appear shifted in respect to the corresponding peaks in the real spectrum. Thus, the user should focus on peak height and shape for assessing the correction reliability.</p>
</div>
</div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>For LIPIC theoretical background see:</p>
<ul>
<li>Andrea Castellaneta, Ilario Losito, Davide Coniglio, Beniamino Leoni, Pietro Santamaria, Maria A. Di Noia, Luigi Palmieri, Cosima D. Calvano, Tommaso R.I. Cataldi: “<em>LIPIC: an automated workflow to account for isotopologues-related interferences in electrospray ionization high resolution mass spectra of phospholipids</em>”, Journal of the American Society for Mass Spectrometry, 2021. DOI: <a href="https://doi.org/10.1021/jasms.1c00008" class="uri">https://doi.org/10.1021/jasms.1c00008</a>.</li>
</ul>
<p>For packages on which LIPIC is based see:</p>
<ul>
<li><p>M. Loos, C. Gerber, F. Corona, J. Hollender, H. Singer: <em>Accelerated Isotope Fine Structure Calculation Using Pruned Transition Trees</em>. Anal. Chem. 87, 5738–5744 (2015). DOI: <a href="https://doi.org/10.1021/acs.analchem.5b00941" class="uri">https://doi.org/10.1021/acs.analchem.5b00941</a>.</p></li>
<li><p>Plotly Technologies Inc.: Collaborative data science, <a href="https://plotly.com/" class="uri">https://plotly.com/</a> (2015).</p></li>
<li><p>R. Wehrens: <em>Chemometrics withR</em>. Springer Verlag, Berlin Heidelberg (2020). DOI: 10.1007/978-3-642-17841-2.</p></li>
</ul>
</div>
<div id="acknowledgments" class="section level2">
<h2 class="hasAnchor">
<a href="#acknowledgments" class="anchor"></a>Acknowledgments</h2>
<p>Thanks to Prof. Ilario Losito, Dr. Davide Coniglio and the other co-workers pertaining to Prof. Tommaso Cataldi’s research group (University of Bari, Italy) for the development of the LIPIC theoretical background.</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/AnCaste/LIPIC/">https://​github.com/​AnCaste/​LIPIC/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/AnCaste/LIPIC/issues">https://​github.com/​AnCaste/​LIPIC/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing LIPIC</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Andrea Castellaneta <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Andrea Castellaneta.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
